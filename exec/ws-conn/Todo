Move connection logic to the separated layer.